<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fiche contact — Pullman Abidjan</title>
<meta name="theme-color" content="#0b0b0c">
<style>
  :root{
    --bg:#0b0b0c;
    --card:#121213;
    --text:#e5e7eb;
    --muted:#a3a3a3;
    --accent:#C5A572;        /* doré Pullman */
    --accent-pressed:#b7965e;
    --ring:rgba(197,165,114,0.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  .wrap{max-width:980px;margin:0 auto;padding:28px 20px}

  /* ===== HERO ===== */
  .hero{
    display:flex; flex-direction:column; align-items:center; text-align:center;
    margin:6px 0 26px;
  }
  .hero h1{
    margin:0 0 10px; font-size:26px; font-weight:650; letter-spacing:.2px;
  }
  .hero p{
    margin:0 0 18px; color:var(--muted); font-size:15px;
  }
  .logo-wrap{ width:100%; display:flex; justify-content:center; margin:10px 0 6px; }
  .logo{
    display:block; width:100%; height:auto; max-width:420px;
    object-fit:contain; image-rendering:-webkit-optimize-contrast;
    filter:contrast(1.02) brightness(0.98);
  }
  @media (max-width:480px){ .logo{ max-width:300px } }

  /* ===== GRID / CARDS ===== */
  .grid{ display:grid; grid-template-columns:1fr; gap:20px; }
  @media (min-width:900px){ .grid{ grid-template-columns:1fr 1fr; } }

  .card{
    background:var(--card);
    border-radius:18px;
    padding:22px 22px;
    box-shadow:0 14px 40px rgba(0,0,0,.28), 0 2px 0 rgba(255,255,255,0.02) inset;
    border:1px solid rgba(255,255,255,0.04);
  }
  .card h2, .card h1{ font-size:22px; margin:0 0 8px }
  .muted{ color:var(--muted); margin:0 0 16px }

  /* ===== ROWS with ICONS ===== */
  .row{ margin:12px 0; display:flex; align-items:center; gap:10px }
  .icon{
    width:22px; height:22px; flex:0 0 22px; display:inline-block;
    color:#d7dde6; opacity:.95;
  }
  .val a{ color:#d7dde6; text-decoration:none }
  .val a:hover{ text-decoration:underline }

  /* ===== BUTTONS ===== */
  .btn{
    display:inline-flex; align-items:center; justify-content:center;
    gap:10px; width:100%;
    margin-top:14px; padding:14px 18px;
    border-radius:999px; font-weight:600; letter-spacing:.2px;
    background:linear-gradient(180deg,var(--accent), var(--accent-pressed));
    color:#1b1b1b; text-decoration:none;
    box-shadow:0 6px 22px rgba(197,165,114,.25);
    border:1px solid rgba(255,255,255,.12);
    transition:transform .06s ease, filter .12s ease, box-shadow .12s ease;
  }
  .btn:active{ transform:translateY(1px); filter:saturate(1.03) brightness(0.98); box-shadow:0 4px 16px rgba(197,165,114,.22); }
  .btn.secondary{
    background:transparent; color:var(--text);
    border:1px solid rgba(255,255,255,.14);
    box-shadow:none;
  }
  .btn-row{ display:flex; flex-direction:column; gap:12px; margin-top:14px }
  @media (min-width:520px){ .btn-row{ flex-direction:row } .btn-row .btn{ width:auto; min-width:260px } }

  /* Site link */
  .site-title{ font-weight:650; margin:0 0 8px; font-size:18px }
  .site-url a{ color:#d7dde6; text-decoration:none; word-break:break-all }

  /* Focus ring accessible */
  a:focus-visible, .btn:focus-visible{
    outline:3px solid var(--ring); outline-offset:3px; border-radius:14px;
  }
</style>
</head>
<body>
  <div class="wrap">

    <!-- HERO -->
    <section class="hero">
      <h1>Bienvenue à l’Hôtel Pullman Abidjan</h1>
      <p>Scannez, enregistrez le contact et découvrez nos services.</p>
      <div class="logo-wrap">
        <img id="logo" class="logo" alt="Logo Pullman Abidjan">
      </div>
    </section>

    <div class="grid">
      <!-- Carte Contact -->
      <section class="card">
        <h2 id="fn">Contact</h2>
        <p id="subtitle" class="muted"></p>

        <div id="row-tel" class="row" style="display:none">
          <!-- Phone icon -->
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2A19.7 19.7 0 0 1 3.1 5.18 2 2 0 0 1 5 3h3a2 2 0 0 1 2 1.72c.12.86.35 1.7.68 2.49a2 2 0 0 1-.45 2.11l-1.27 1.27a16 16 0 0 0 6.29 6.29l1.27-1.27a2 2 0 0 1 2.11-.45c.79.33 1.63.56 2.49.68A2 2 0 0 1 22 16.92z"/>
          </svg>
          <div class="val"><a id="telLink"></a></div>
        </div>

        <div id="row-mail" class="row" style="display:none">
          <!-- Mail icon -->
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M4 4h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>
            <polyline points="22,6 12,13 2,6"/>
          </svg>
          <div class="val"><a id="mailLink"></a></div>
        </div>

        <div class="btn-row">
          <a id="btnVcf" class="btn" href="#" aria-label="Enregistrer le contact">
            <!-- Download icon -->
            <svg class="icon" style="color:#1b1b1b" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            Enregistrer le contact (.vcf)
          </a>

          <a id="wa" class="btn secondary" href="#" target="_blank" rel="noopener" style="display:none" aria-label="Ouvrir WhatsApp">
            <!-- WhatsApp icon -->
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
              <path d="M19.05 4.91A9 9 0 0 0 4.91 19.05L3 21l1.95-1.91A9 9 0 1 0 19.05 4.91Zm-7.86 2.42c.21 0 .44.01.66.04a.62.62 0 0 1 .52.42c.14.38.45 1.33.49 1.44.08.21.05.37-.03.49-.08.12-.12.17-.24.28-.12.11-.21.24-.09.46.12.21.53.87 1.14 1.41.78.69 1.43.9 1.65 1.01.21.11.34.1.47-.06.13-.16.54-.63.68-.85.14-.22.28-.18.47-.11.19.08 1.21.57 1.42.67.21.11.35.16.4.25.06.09.06.52-.12 1.02-.18.5-1.02.98-1.43 1.05-.37.06-.83.09-1.34-.08-.31-.1-.71-.23-1.22-.46-2.14-.92-3.53-3.09-3.64-3.24-.11-.15-.87-1.17-1.1-2.2-.24-1.03.13-1.67.3-1.91.17-.24.37-.38.5-.43.13-.05.29-.04.37-.03Z"/>
            </svg>
            WhatsApp
          </a>
        </div>
      </section>

      <!-- Carte Site -->
      <section class="card">
        <h2 class="site-title">À propos de l’hôtel</h2>
        <p class="muted">Accédez à nos services, offres et informations officielles.</p>

        <div class="row">
          <!-- Globe icon -->
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="12" cy="12" r="10"/>
            <line x1="2" y1="12" x2="22" y2="12"/>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          <div class="val site-url"><a id="siteLink2" href="#" target="_blank" rel="noopener"></a></div>
        </div>

        <div class="btn-row">
          <a id="btnSite" class="btn" href="#" target="_blank" rel="noopener" aria-label="Visiter le site Pullman Abidjan">
            <!-- External link icon -->
            <svg class="icon" style="color:#1b1b1b" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M18 13v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
              <polyline points="15 3 21 3 21 9"/>
              <line x1="10" y1="14" x2="21" y2="3"/>
            </svg>
            Visiter le site Pullman Abidjan
          </a>

          <a id="siteLink" class="btn secondary" href="#" target="_blank" rel="noopener" aria-label="Ouvrir dans un nouvel onglet">
            <!-- Link icon -->
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M10 13a5 5 0 0 1 0-7l1-1a5 5 0 1 1 7 7l-1 1"/>
              <path d="M14 11a5 5 0 0 1 0 7l-1 1a5 5 0 1 1-7-7l1-1"/>
            </svg>
            Ouvrir dans un nouvel onglet
          </a>
        </div>
      </section>
    </div>
  </div>

<script>
(function(){
  function qs(k){return new URL(location.href).searchParams.get(k)||''}
  const id = qs('id').trim();
  if(!id){ document.body.innerHTML = '<div style="padding:24px">Paramètre id manquant</div>'; return; }

  // Apps Script JSONP endpoint — ton ID de déploiement
  const DEPLOY_ID = 'AKfycbx6gzLF2I63qsrjP-NzAZSvJFpHk03HQEbHtM2mfe4cHovumTGAfSnwsTKGLw1Lt0stSA';
  const API = `https://script.google.com/macros/s/${DEPLOY_ID}/exec?mode=jsonp&id=${encodeURIComponent(id)}&callback=onData`;

  window.onData = function(data){
    if(data.error){ document.body.innerHTML = '<div style="padding:24px">'+data.error+'</div>'; return; }

    // Logo (data URL fournie par l’API)
    if (data.logoDataUrl) document.getElementById('logo').src = data.logoDataUrl;

    // Nom complet
    const fn = [data.prenom||'', data.nom||''].filter(Boolean).join(' ').trim() || 'Contact';
    document.getElementById('fn').textContent = fn;

    // Sous-titre : poste uniquement (DA épurée)
    document.getElementById('subtitle').textContent = (data.poste||'');

    // Téléphone
    if (data.telephone) {
      const telOnlyDigits = data.telephone.replace(/[^\d+]/g,'');
      const telA = document.getElementById('telLink');
      telA.textContent = data.telephone;
      telA.href = `tel:${data.telephone}`;
      document.getElementById('row-tel').style.display = '';

      // WhatsApp (bouton secondaire)
      const wa = document.getElementById('wa');
      wa.href = `https://wa.me/${telOnlyDigits.replace(/[^\d]/g,'')}`;
      wa.style.display = '';
    }

    // Email
    if (data.email) {
      const m = document.getElementById('mailLink');
      m.textContent = data.email;
      m.href = `mailto:${data.email}`;
      document.getElementById('row-mail').style.display = '';
    }

    // Site (unique)
    const site = data.hotelSite || 'https://www.flowcode.com/page/pullmanabidjan0?preview=true';
    document.getElementById('siteLink').href = site;
    document.getElementById('siteLink2').href = site;
    document.getElementById('siteLink2').textContent = site;
    document.getElementById('btnSite').href = site;

    // vCard locale (sans organisation)
    document.getElementById('btnVcf').addEventListener('click', function(ev){
      ev.preventDefault();
      const lines = [
        'BEGIN:VCARD','VERSION:3.0',
        'N:'+(data.nom||'')+';'+(data.prenom||'')+';;;',
        'FN:'+fn
      ];
      if (data.poste)      lines.push('TITLE:'+data.poste);
      if (data.telephone)  lines.push('TEL;TYPE=CELL,VOICE:'+data.telephone);
      if (data.email)      lines.push('EMAIL;TYPE=INTERNET:'+data.email);
      if (site)            lines.push('URL:'+site);
      lines.push('END:VCARD');

      const v = lines.join('\r\n');
      const blob = new Blob([v], {type: 'text/vcard;charset=utf-8'});
      const url  = URL.createObjectURL(blob);
      const a    = document.createElement('a');
      a.href = url;
      a.download = (fn.replace(/[^\w\- ]+/g,'').trim() || 'contact') + '.vcf';
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 1000);
    });
  };

  // Charge JSONP
  const s = document.createElement('script');
  s.src = API;
  document.body.appendChild(s);
})();
</script>
</body>
</html>
