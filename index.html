<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Contact — Pullman Abidjan</title>
<meta name="theme-color" content="#0b6b48">

<!-- iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://script.google.com" crossorigin>
<link rel="preconnect" href="https://script.googleusercontent.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- ==== EARLY DATA LOAD (INTOUCHABLE) ==== -->
<script>
(function(){
  function qs(k){return new URL(location.href).searchParams.get(k)||''}
  const id=(qs('id')||'').trim();
  if(!id){
    document.documentElement.innerHTML='<body style="padding:24px;color:#fff;background:#000">Paramètre id manquant</body>';
    return;
  }

  const DEPLOY_ID='AKfycbx6gzLF2I63qsrjP-NzAZSvJFpHk03HQEbHtM2mfe4cHovumTGAfSnwsTKGLw1Lt0stSA';
  const API=`https://script.google.com/macros/s/${DEPLOY_ID}/exec?mode=jsonp&id=${encodeURIComponent(id)}&callback=onDataEarly`;
  const CACHE_KEY=`contact_cache_${id}`;
  const CACHE_TTL=12*60*60*1000;

  window.onDataEarly=function(data){
    try{
      if(data && !data.error){
        window.__contactData=data;
        localStorage.setItem(CACHE_KEY,JSON.stringify({ts:Date.now(),data}));
        if(typeof window.__renderContact==='function'){
          window.__renderContact(data,true);
        }
      }else{
        window.__contactDataError=(data && data.error)||'Erreur';
      }
    }catch(e){}
  };

  var js=document.createElement('script');
  js.src=API;
  document.head.appendChild(js);

  window.__contactConfig={id,CACHE_KEY,CACHE_TTL};
})();
</script>

<style>
:root{
  --bg-img:url('assets/bg.jpg');
  --contact-bg:url('assets/fond-contact.jpg');

  --heritage:#0b6b48;
  --vibrant:#00c070;

  --overlay:linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.78));
  --radius-xl:22px;
  --radius-md:14px;
  --ease:cubic-bezier(.2,.9,.3,1);
}

*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}

body{
  font-family:'Noto Sans',system-ui,sans-serif;
  background:var(--overlay),var(--bg-img);
  background-size:cover;
  background-position:center;
  background-attachment:fixed;
  color:#f9fafb;
}

.wrap{
  max-width:620px;
  margin:auto;
  padding:20px;
  padding-top:calc(20px + env(safe-area-inset-top));
  padding-bottom:calc(20px + env(safe-area-inset-bottom));
}

/* HERO */
.hero{text-align:center;margin-bottom:28px}
.hero h1{font-size:22px;font-weight:700}
.hero p{font-size:15px;color:#d1d5db;margin-top:4px}

/* CARDS */
.card{
  position:relative;
  border-radius:var(--radius-xl);
  overflow:hidden;
  margin-bottom:18px;
  padding:24px 22px;
  border:1px solid rgba(255,255,255,.12);
  box-shadow:0 12px 30px rgba(0,0,0,.35);
}
.card.contact{background:var(--contact-bg) center/cover no-repeat}
.card.site{background:var(--bg-img) center/cover no-repeat}
.card::before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.75));
}
.card::after{
  content:"";
  position:absolute;
  width:380px;
  height:380px;
  border-radius:50%;
  right:-180px;
  top:-160px;
  background:linear-gradient(180deg,var(--heritage),var(--vibrant));
  opacity:.18;
}
.card > *{position:relative;z-index:1}

/* TEXT */
h2{text-align:center;font-size:19px;font-weight:700;margin-bottom:6px}
.muted{text-align:center;font-size:14px;color:#e5e7eb;margin-bottom:16px}

/* ROWS */
.row{
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 14px;
  border-radius:var(--radius-md);
  cursor:pointer;
}
.row:active{background:rgba(255,255,255,.08)}
.icon{width:20px;height:20px;color:var(--vibrant)}
.val a{color:#fff;text-decoration:none;font-size:15px}
.copy{
  margin-left:auto;
  padding:6px 10px;
  border-radius:10px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.25);
  color:#fff;
  font-size:12px;
}

/* BUTTON */
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:16px 28px;
  border-radius:40px;
  font-weight:700;
  font-size:14px;
  background:var(--vibrant);
  color:#0a0a0a;
  text-decoration:none;
  border:none;
  width:min(420px,92%);
  box-shadow:0 10px 24px rgba(0,0,0,.35);
  transition:transform .25s var(--ease);
}
.btn:hover{transform:translateY(-2px)}
.btn-wrap{text-align:center;margin-top:18px}

/* BANNER */
.banner{
  height:220px;
  border-radius:18px;
  overflow:hidden;
  position:relative;
  border:1px solid rgba(255,255,255,.18);
}
.banner::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(180deg,rgba(0,0,0,.25),rgba(0,0,0,.6));
}
.banner-content{
  position:absolute;
  inset:0;
  z-index:2;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  gap:8px;
}
.banner h3{font-size:18px;font-weight:700}
.banner p{font-size:13px;color:#f3f4f6}

/* SKELETON */
.skel .bar{
  height:12px;
  border-radius:8px;
  background:rgba(255,255,255,.25);
  animation:pulse 1.2s infinite ease-in-out;
}
@keyframes pulse{0%{opacity:.5}50%{opacity:1}100%{opacity:.5}}
</style>
</head>

<body>
<div class="wrap">

  <section class="hero">
    <h1>Bienvenue à l’Hôtel Pullman Abidjan</h1>
    <p>Scannez pour enregistrer le contact ou visiter notre site.</p>
  </section>

  <section class="card contact" id="contactCard">
    <h2 id="fn">Contact</h2>
    <p id="subtitle" class="muted"></p>

    <div id="skel" class="skel">
      <div class="row"><div class="bar" style="width:60%"></div></div>
      <div class="row"><div class="bar" style="width:40%"></div></div>
      <div class="row"><div class="bar" style="width:70%"></div></div>
    </div>

    <div id="row-tel" class="row" style="display:none">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 16.92v3a2 2 0 0 1-2.18 2A19.7 19.7 0 0 1 3.1 5.18A2 2 0 0 1 5 3h3"/>
      </svg>
      <div class="val"><a id="telLink"></a></div>
      <button class="copy">Copier</button>
    </div>

    <div id="row-wa" class="row" style="display:none">
      <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19.05 4.91A9 9 0 0 0 4.91 19.05L3 21l1.95-1.91A9 9 0 1 0 19.05 4.91Z"/>
      </svg>
      <div class="val"><a id="waLink"></a></div>
    </div>

    <div id="row-mail" class="row" style="display:none">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 4h16v16H4z"/>
        <polyline points="22,6 12,13 2,6"/>
      </svg>
      <div class="val"><a id="mailLink"></a></div>
      <button class="copy">Copier</button>
    </div>

    <div class="btn-wrap">
      <a id="btnVcf" class="btn" href="#">Enregistrer le contact</a>
    </div>
  </section>

  <section class="card site">
    <div class="banner">
      <div class="banner-content">
        <h3>Pullman Abidjan — Officiel</h3>
        <p>Offres, services, événements et plus.</p>
        <a id="btnSiteHero" class="btn" href="#" target="_blank">Visiter le site</a>
      </div>
    </div>
  </section>

</div>

<div id="iosTip" style="display:none;position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
background:rgba(0,0,0,.86);color:#fff;padding:10px 14px;border-radius:12px;font-size:13px;z-index:50;">
Astuce iPhone : si le contact s’ouvre en fichier, touchez <b>Partager</b> puis “Enregistrer dans Contacts”.
</div>

<!-- ==== JS RENDU (INTOUCHABLE) ==== -->
<script>
(function(){
  const { id, CACHE_KEY, CACHE_TTL } = window.__contactConfig || {};
  if(!id){ return; }

  const telLink=document.getElementById('telLink');
  const mailLink=document.getElementById('mailLink');
  const waLink=document.getElementById('waLink');
  const rowTel=document.getElementById('row-tel');
  const rowWa=document.getElementById('row-wa');
  const rowMail=document.getElementById('row-mail');
  const btnSiteHero=document.getElementById('btnSiteHero');
  const btnVcf=document.getElementById('btnVcf');
  const iosTip=document.getElementById('iosTip');
  const skel=document.getElementById('skel');

  function render(d){
    if(skel) skel.style.display='none';

    const fn=[d.prenom||'',d.nom||''].join(' ').trim()||'Contact';
    document.getElementById('fn').textContent=fn;
    document.getElementById('subtitle').textContent=d.poste||'';

    if(d.telephone){
      const tel=d.telephone.trim();
      telLink.textContent=tel;
      telLink.href=`tel:${tel}`;
      rowTel.style.display='';

      /* WHATSAPP – FORMAT INTERNATIONAL CI */
      let waNum = tel.replace(/[^\d]/g,'');
      if(waNum.startsWith('0')){
        waNum = '225' + waNum.slice(1);
      }

      waLink.textContent='WhatsApp';
      waLink.href=`https://wa.me/${waNum}`;
      rowWa.style.display='';
    }

    if(d.email){
      mailLink.textContent=d.email;
      mailLink.href=`mailto:${d.email}`;
      rowMail.style.display='';
    }

    btnSiteHero.href=d.hotelSite||'#';

    btnVcf.onclick=(e)=>{
      e.preventDefault();
      const lines=[
        'BEGIN:VCARD',
        'VERSION:3.0',
        `FN:${fn}`
      ];
      if(d.telephone) lines.push('TEL:'+d.telephone);
      if(d.email) lines.push('EMAIL:'+d.email);
      lines.push('END:VCARD');

      const blob=new Blob([lines.join('\r\n')],{type:'text/vcard'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');
      a.href=url;
      a.download='contact.vcf';
      a.click();
      setTimeout(()=>URL.revokeObjectURL(url),1000);

      if(/iPhone|iPad/.test(navigator.userAgent)){
        iosTip.style.display='block';
        setTimeout(()=>iosTip.style.display='none',5000);
      }
    };
  }

  window.__renderContact=render;

  if(window.__contactData){
    render(window.__contactData);
    return;
  }

  try{
    const raw=localStorage.getItem(CACHE_KEY);
    if(raw){
      const c=JSON.parse(raw);
      if(c && Date.now()-c.ts<CACHE_TTL){
        render(c.data);
      }
    }
  }catch{}
})();
</script>

</body>
</html>
