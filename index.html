<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Contact — Pullman Abidjan</title>
<meta name="theme-color" content="#0b0b0c">

<!-- iOS safe-areas & web app look -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Boost perf Google Fonts & Apps Script -->
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://script.google.com" crossorigin>
<link rel="preconnect" href="https://script.googleusercontent.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg-img:url('assets/bg.jpg');
  --contact-bg:url('assets/fond-contact.jpg');
  --overlay:linear-gradient(180deg, rgba(0,0,0,.65), rgba(0,0,0,.8));
  --accent:#C5A572;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;margin:0;padding:0}
body{
  background:var(--overlay),var(--bg-img);
  background-size:cover;background-position:center;background-attachment:fixed;
  font-family:'Montserrat',sans-serif;color:#111827;
}
.wrap{
  max-width:600px;margin:auto;padding:20px;
  padding-top:calc(20px + env(safe-area-inset-top));
  padding-bottom:calc(20px + env(safe-area-inset-bottom));
}
.hero{text-align:center;margin-bottom:24px;color:#f9fafb;}
.hero h1{font-size:22px;font-weight:600;margin-bottom:4px;}
.hero p{color:#d1d5db;font-size:15px;margin:0;}
.card.contact,.card.site{
  border:1px solid var(--accent);border-radius:20px;padding:22px;margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,0.15);color:#fff;position:relative;overflow:hidden;
}
.card.contact{background:var(--contact-bg) center/cover no-repeat;}
.card.contact::before{content:"";position:absolute;inset:0;background:rgba(0,0,0,0.45);}
.card.site{background:var(--bg-img) center/cover no-repeat;}
.card.site::before{content:"";position:absolute;inset:0;background:rgba(0,0,0,0.55);}
.card.contact *, .card.site *{position:relative;z-index:1;}
h2{text-align:center;font-size:19px;margin-bottom:10px;font-weight:600;}
.muted{text-align:center;color:#e5e7eb;margin-bottom:14px;font-size:14px;}
.row{display:flex;align-items:center;gap:10px;margin:10px 0;cursor:pointer;
     border-radius:12px;padding:8px;}
.row:active{background:rgba(255,255,255,0.08);}
.icon{width:20px;height:20px;color:var(--accent);}
.val a{color:#fff;font-size:15px;text-decoration:none;}
.copy{margin-left:auto;padding:6px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.22);
      background:rgba(255,255,255,.06);color:#fff;font-size:12px;}
.copy:active{opacity:.85}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;
     padding:12px 26px;border-radius:40px;font-weight:600;font-size:14px;
     background:var(--accent);color:#1b1b1b;text-decoration:none;border:none;
     margin:14px auto 0;box-shadow:0 3px 8px rgba(0,0,0,0.25);
     transition:all .25s ease;min-height:44px;width:min(420px,92%);}
.btn:hover{transform:translateY(-1px);box-shadow:0 5px 12px rgba(0,0,0,0.3);}
.btn:active{opacity:.85}
.btn-wrap{text-align:center}
.banner{position:relative;border-radius:16px;overflow:hidden;height:220px;
        background:var(--bg-img) center/cover no-repeat;border:1px solid var(--accent);}
.banner::after{content:"";position:absolute;inset:0;
               background:linear-gradient(180deg,rgba(0,0,0,0.25),rgba(0,0,0,0.55));}
.banner-content{position:absolute;inset:0;display:flex;flex-direction:column;
                align-items:center;justify-content:center;gap:8px;text-align:center;
                z-index:2;padding:12px;color:#fff;}
.banner h3{margin:0;font-size:18px;font-weight:700}
.banner p{margin:0;color:#f3f4f6;font-size:13px}
.btn:focus-visible,a:focus-visible,.row:focus-visible,.copy:focus-visible{
  outline:2px solid #fff;outline-offset:2px;border-radius:12px;}
@media(max-width:420px){
  .card.site{background-image:url('assets/bg-mobile.jpg');}
  .card.contact{background-image:url('assets/fond-contact-mobile.jpg');}
  .banner{background-image:url('assets/bg-mobile.jpg');}
}
</style>
</head>
<body>
<div class="wrap">
  <section class="hero">
    <h1>Bienvenue à l’Hôtel Pullman Abidjan</h1>
    <p>Scannez pour enregistrer le contact ou visiter notre site.</p>
  </section>

  <section class="card contact">
    <h2 id="fn">Contact</h2>
    <p id="subtitle" class="muted"></p>
    <div id="row-tel" class="row" style="display:none" tabindex="0">
      <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
           stroke-linejoin="round" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 0 1-2.18 2
           A19.7 19.7 0 0 1 3.1 5.18A2 2 0 0 1 5 3h3a2 2 0 0 1 2 1.72c.12.86.35 1.7.68 2.49
           a2 2 0 0 1-.45 2.11l-1.27 1.27a16 16 0 0 0 6.29 6.29l1.27-1.27
           a2 2 0 0 1 2.11-.45c.79.33 1.63.56 2.49.68A2 2 0 0 1 22 16.92z"/></svg>
      <div class="val"><a id="telLink"></a></div>
      <button class="copy">Copier</button>
    </div>
    <div id="row-wa" class="row" style="display:none" tabindex="0">
      <svg class="icon" fill="currentColor" viewBox="0 0 24 24">
        <path d="M19.05 4.91A9 9 0 0 0 4.91 19.05L3 21l1.95-1.91A9 9 0 1 0 19.05 4.91Z"/></svg>
      <div class="val"><a id="waLink"></a></div>
    </div>
    <div id="row-mail" class="row" style="display:none" tabindex="0">
      <svg class="icon" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
           stroke-linejoin="round" viewBox="0 0 24 24">
           <path d="M4 4h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4
           a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>
           <polyline points="22,6 12,13 2,6"/></svg>
      <div class="val"><a id="mailLink"></a></div>
      <button class="copy">Copier</button>
    </div>
    <div class="btn-wrap"><a id="btnVcf" class="btn" href="#">Enregistrer le contact</a></div>
  </section>

  <section class="card site">
    <div class="banner">
      <div class="banner-content">
        <h3>Pullman Abidjan — Officiel</h3>
        <p>Offres, services, événements et plus.</p>
        <a id="btnSiteHero" class="btn" href="#" target="_blank" rel="noopener">Visiter le site</a>
      </div>
    </div>
  </section>
</div>

<div id="iosTip" style="display:none;position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
background:rgba(0,0,0,.86);color:#fff;padding:10px 14px;border-radius:12px;font-size:13px;z-index:50;">
Astuce iPhone : si le contact s’ouvre en fichier, touchez <b>Partager</b> puis “Enregistrer dans Contacts”.
</div>

<script>
(function(){
  function qs(k){return new URL(location.href).searchParams.get(k)||''}
  const id=qs('id')?.trim();
  if(!id){document.body.innerHTML='<div style="padding:24px;color:#fff">Paramètre id manquant</div>';return;}

  const DEPLOY_ID='AKfycbx6gzLF2I63qsrjP-NzAZSvJFpHk03HQEbHtM2mfe4cHovumTGAfSnwsTKGLw1Lt0stSA';
  const API=`https://script.google.com/macros/s/${DEPLOY_ID}/exec?mode=jsonp&id=${encodeURIComponent(id)}&callback=onData`;
  const CACHE_KEY=`contact_cache_${id}`;
  const CACHE_TTL=12*60*60*1000;

  function render(d){
    const fn=[d.prenom||'',d.nom||''].filter(Boolean).join(' ').trim()||'Contact';
    document.getElementById('fn').textContent=fn;
    document.getElementById('subtitle').textContent=d.poste||'';
    if(d.telephone){
      const tel=(d.telephone+'').trim();
      telLink.textContent=tel; telLink.href=`tel:${tel}`;
      rowTel.style.display=''; const waNum=tel.replace(/[^\d]/g,'');
      waLink.textContent='WhatsApp'; waLink.href=`https://wa.me/${waNum}`;
      rowWa.style.display='';
    }
    if(d.email){mailLink.textContent=d.email;mailLink.href=`mailto:${d.email}`;rowMail.style.display='';}
    const site=d.hotelSite||'https://www.flowcode.com/page/pullmanabidjan0?preview=true';
    btnSiteHero.href=site;

    function clickRow(id,sel){const r=document.getElementById(id);
      if(!r)return;r.onclick=()=>{const a=r.querySelector(sel);if(a&&a.href)location.href=a.href;};}
    clickRow('row-tel','#telLink');clickRow('row-wa','#waLink');clickRow('row-mail','#mailLink');

    function copyBtn(id,sel){const r=document.getElementById(id),b=r?.querySelector('.copy'),a=r?.querySelector(sel);
      if(!b||!a)return;b.onclick=async(e)=>{e.stopPropagation();try{
        await navigator.clipboard.writeText((a.textContent||'').trim());
        b.textContent="Copié !";setTimeout(()=>b.textContent="Copier",1400);
      }catch{b.textContent="Erreur";setTimeout(()=>b.textContent="Copier",1200);}};}
    copyBtn('row-tel','#telLink');copyBtn('row-mail','#mailLink');

    btnVcf.onclick=(ev)=>{
      ev.preventDefault();
      const lines=['BEGIN:VCARD','VERSION:3.0',`N:${d.nom||''};${d.prenom||''};;;`,`FN:${fn}`];
      if(d.poste)lines.push('TITLE:'+d.poste);
      if(d.telephone)lines.push('TEL;TYPE=CELL,VOICE:'+d.telephone);
      if(d.email)lines.push('EMAIL;TYPE=INTERNET:'+d.email);
      if(site)lines.push('URL:'+site);lines.push('END:VCARD');
      const blob=new Blob([lines.join('\r\n')],{type:'text/vcard;charset=utf-8'});
      const url=URL.createObjectURL(blob);
      const a=document.createElement('a');a.href=url;a.download=(fn||'contact')+'.vcf';a.click();
      setTimeout(()=>URL.revokeObjectURL(url),1000);
      if(/iPad|iPhone|iPod/.test(navigator.userAgent)){
        iosTip.style.display='block';setTimeout(()=>iosTip.style.display='none',5000);
      }
    };
  }

  try{
    const raw=localStorage.getItem(CACHE_KEY);
    if(raw){
      const c=JSON.parse(raw);
      if(c&&c.ts&&(Date.now()-c.ts)<CACHE_TTL&&c.data)render(c.data);
    }
  }catch{}

  window.onData=function(d){
    if(d&& !d.error){
      try{localStorage.setItem(CACHE_KEY,JSON.stringify({ts:Date.now(),data:d}));}catch{}
      render(d);
    }else if(!localStorage.getItem(CACHE_KEY)){
      document.body.innerHTML='<div style="padding:24px;color:#fff">'+(d?.error||'Erreur de chargement')+'</div>';
    }
  };
  const s=document.createElement('script');s.src=API;s.async=true;document.body.appendChild(s);
})();
</script>
</body>
</html>
