<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Contact — Pullman Abidjan</title>
<meta name="theme-color" content="#0b0b0c">
<style>
  :root {
    --bg:#0b0b0c;
    --card:#121213;
    --text:#e5e7eb;
    --muted:#a3a3a3;
    --accent:#C5A572;
    --accent-pressed:#b7965e;
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
  body{
    margin:0;background:var(--bg);color:var(--text);
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
  }
  .wrap{max-width:600px;margin:0 auto;padding:20px}
  .hero{text-align:center;margin:10px 0 20px}
  .hero h1{font-size:22px;font-weight:600;margin:0 0 6px}
  .hero p{color:var(--muted);font-size:15px;margin:0 0 12px}
  .logo{max-width:320px;width:80%;height:auto;margin:auto;display:block;object-fit:contain}

  .card{background:var(--card);border-radius:18px;padding:20px;margin-bottom:18px;box-shadow:0 6px 24px rgba(0,0,0,.25)}
  h2{font-size:19px;margin:0 0 10px;text-align:center}
  .muted{color:var(--muted);margin:0 0 16px;text-align:center}
  .row{display:flex;align-items:center;gap:12px;margin:12px 0}
  .icon{width:24px;height:24px;color:var(--accent);flex-shrink:0}
  .val a{color:var(--text);font-size:16px;text-decoration:none}
  .val a:active{opacity:.7}
  .btn{display:flex;align-items:center;justify-content:center;gap:10px;width:100%;
    padding:14px 18px;border-radius:999px;font-weight:600;
    background:linear-gradient(180deg,var(--accent),var(--accent-pressed));
    color:#1b1b1b;text-decoration:none;font-size:16px;box-shadow:0 6px 18px rgba(197,165,114,.25);
    border:none;transition:all .15s ease;}
  .btn:active{transform:scale(.98)}
  .btn.secondary{background:transparent;color:var(--accent);border:1px solid var(--accent);box-shadow:none}
  .btn svg{color:currentColor;width:22px;height:22px}
  .site-title{text-align:center;font-weight:600;margin:0 0 6px;font-size:18px}
  .site-url{text-align:center;word-break:break-all;color:var(--muted);font-size:14px}
</style>
</head>
<body>
<div class="wrap">
  <section class="hero">
    <h1>Bienvenue à l’Hôtel Pullman Abidjan</h1>
    <p>Scannez, enregistrez le contact et découvrez nos services.</p>
    <img id="logo" class="logo" alt="Logo Pullman Abidjan">
  </section>

  <section class="card">
    <h2 id="fn">Contact</h2>
    <p id="subtitle" class="muted"></p>

    <div id="row-tel" class="row" style="display:none">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2A19.7 19.7 0 0 1 3.1 5.18 2 2 0 0 1 5 3h3a2 2 0 0 1 2 1.72c.12.86.35 1.7.68 2.49a2 2 0 0 1-.45 2.11l-1.27 1.27a16 16 0 0 0 6.29 6.29l1.27-1.27a2 2 0 0 1 2.11-.45c.79.33 1.63.56 2.49.68A2 2 0 0 1 22 16.92z"/></svg>
      <div class="val"><a id="telLink"></a></div>
    </div>

    <div id="row-mail" class="row" style="display:none">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
      <div class="val"><a id="mailLink"></a></div>
    </div>

    <div class="row" id="row-wa" style="display:none">
      <svg class="icon" viewBox="0 0 24 24" fill="currentColor"><path d="M19.05 4.91A9 9 0 0 0 4.91 19.05L3 21l1.95-1.91A9 9 0 1 0 19.05 4.91Zm-7.86 2.42c.21 0 .44.01.66.04a.62.62 0 0 1 .52.42c.14.38.45 1.33.49 1.44.08.21.05.37-.03.49-.08.12-.12.17-.24.28-.12.11-.21.24-.09.46.12.21.53.87 1.14 1.41.78.69 1.43.9 1.65 1.01.21.11.34.1.47-.06.13-.16.54-.63.68-.85.14-.22.28-.18.47-.11.19.08 1.21.57 1.42.67.21.11.35.16.4.25.06.09.06.52-.12 1.02-.18.5-1.02.98-1.43 1.05-.37.06-.83.09-1.34-.08-.31-.1-.71-.23-1.22-.46-2.14-.92-3.53-3.09-3.64-3.24-.11-.15-.87-1.17-1.1-2.2-.24-1.03.13-1.67.3-1.91.17-.24.37-.38.5-.43.13-.05.29-.04.37-.03Z"/></svg>
      <div class="val"><a id="waLink"></a></div>
    </div>

    <a id="btnVcf" class="btn" href="#">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
      Enregistrer le contact
    </a>
  </section>

  <section class="card">
    <h2 class="site-title">À propos de l’hôtel</h2>
    <p class="muted">Accédez à nos services et informations officielles.</p>
    <div class="site-url"><a id="siteLink2" href="#" target="_blank" rel="noopener"></a></div>
    <a id="btnSite" class="btn" href="#" target="_blank" rel="noopener">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
      Visiter le site Pullman Abidjan
    </a>
  </section>
</div>

<script>
(function(){
  function qs(k){return new URL(location.href).searchParams.get(k)||''}
  const id = qs('id').trim();
  if(!id){ document.body.innerHTML = '<div style="padding:24px">Paramètre id manquant</div>'; return; }

  const DEPLOY_ID = 'AKfycbx6gzLF2I63qsrjP-NzAZSvJFpHk03HQEbHtM2mfe4cHovumTGAfSnwsTKGLw1Lt0stSA';
  const API = `https://script.google.com/macros/s/${DEPLOY_ID}/exec?mode=jsonp&id=${encodeURIComponent(id)}&callback=onData`;

  window.onData = function(data){
    if(data.error){ document.body.innerHTML = '<div style="padding:24px">'+data.error+'</div>'; return; }

    if (data.logoDataUrl) document.getElementById('logo').src = data.logoDataUrl;
    const fn = [data.prenom||'', data.nom||''].filter(Boolean).join(' ').trim() || 'Contact';
    document.getElementById('fn').textContent = fn;
    document.getElementById('subtitle').textContent = data.poste || '';

    if (data.telephone) {
      const tel = data.telephone;
      document.getElementById('telLink').textContent = tel;
      document.getElementById('telLink').href = `tel:${tel}`;
      document.getElementById('row-tel').style.display = '';
      const wa = tel.replace(/[^\d]/g,'');
      const waUrl = `https://wa.me/${wa}`;
      document.getElementById('waLink').textContent = 'WhatsApp';
      document.getElementById('waLink').href = waUrl;
      document.getElementById('row-wa').style.display = '';
    }

    if (data.email) {
      const m = document.getElementById('mailLink');
      m.textContent = data.email;
      m.href = `mailto:${data.email}`;
      document.getElementById('row-mail').style.display = '';
    }

    const site = data.hotelSite || 'https://www.flowcode.com/page/pullmanabidjan0?preview=true';
    document.getElementById('siteLink2').href = site;
    document.getElementById('siteLink2').textContent = site;
    document.getElementById('btnSite').href = site;

    document.getElementById('btnVcf').addEventListener('click', ev=>{
      ev.preventDefault();
      const lines = [
        'BEGIN:VCARD','VERSION:3.0',
        `N:${data.nom||''};${data.prenom||''};;;`,
        `FN:${fn}`,
      ];
      if (data.poste) lines.push('TITLE:'+data.poste);
      if (data.telephone) lines.push('TEL;TYPE=CELL,VOICE:'+data.telephone);
      if (data.email) lines.push('EMAIL;TYPE=INTERNET:'+data.email);
      if (site) lines.push('URL:'+site);
      lines.push('END:VCARD');
      const v = lines.join('\r\n');
      const blob = new Blob([v], {type:'text/vcard;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = fn.replace(/[^\w\- ]+/g,'').trim() + '.vcf';
      a.click();
      setTimeout(()=>URL.revokeObjectURL(url),1000);
    });
  };

  const s=document.createElement('script');
  s.src=API; document.body.appendChild(s);
})();
</script>
</body>
</html>
